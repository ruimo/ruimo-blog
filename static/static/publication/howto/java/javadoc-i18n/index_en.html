<?xml version="1.0" encoding="Shift_JIS"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS"/>
  <link rel="stylesheet" type="text/css" href="/stylesheet.css"/>
  <title>JavaDoc meets FreeMarker</title>
</head>
<body>
<p><a href="index.html">日本語版</a></p>
<h1>FreemMarker meets JavaDoc </h1>
<h4>31st Dec.'06</h4>
<p>Unfortunately, the current version of JavaDoc does not support i18n(internationalization). <a href="http://java.sun.com/j2se/javadoc/faq/index.html#localizationdoclets">Here</a> shows that there is a Doclet for i18n but it is not generally available and the procedure seems a bit difficult. Here shows an idea to use <a href="http://freemarker.sourceforge.net/">FreeMarker</a> to generate JavaDoc documents.</p>

<p>
FreeMarker is a template engine. This can be used as a pre-processor for Java source code also. In this manner, you can place JavaDoc comments in more than one language into your single source code:
</p>

<pre class="codeSample">
/**
&lt;#if locale="ja"&gt;
サイズ0配列。
&lt;#else&gt;
Empty arrays.
&lt;/#if&gt;
 */
public class EmptyArrays {
    EmptyArrays() {}
</pre>

<p>
&lt;#...&gt; represents the directive of FreeMarker. One of the important things is that you place all of the FreeMarker directives in the JavaDoc comment so that the source code is still able to be compiled by javac without FreeMarker processing. This also ensures that line numbers in compilation errors are correctly point the error lines. Use appropriate encoding to write your source code such as UTF-8 so that JavaDoc comment in more than one language can sit in single source file. When you compile your source code by javac, make sure to specify -encoding option. Otherwise, javac will complain if the default encoding is different than one of your environment.
</p>

<p>
You can generate JavaDoc by an Ant task. First of all, download FMPP from <a href="http://freemarker.sourceforge.net/fmpp.html">here</a> and unpack the archive into appropriate directory. Once you get the fmpp.jar file, you can run the JavaDoc by the following Ant task:
</p>

<pre class="codeSample">
  &lt;property name="fmpp.lib" path="/usr/local/java/freemarker/fmpp_0.9.11/lib/fmpp.jar"/&gt;
  &lt;taskdef name="fmpp" classname="fmpp.tools.AntTask" classpath="${fmpp.lib}"/&gt;

  &lt;target name="javadoc" description="Generate javadoc."&gt;
    &lt;macrodef name="javadoc-i18n"&gt;
      &lt;attribute name="locale"/&gt;
      &lt;sequential&gt;
        &lt;mkdir dir="javadocsrc-@{locale}"/&gt;
        &lt;fmpp sourceroot="src" outputroot="javadocsrc-@{locale}"
              data="locale:@{locale}" logfile="log-@{locale}.fmpp"/&gt;   
        &lt;javadoc sourcepath="javadocsrc-@{locale}" destdir="javadoc-@{locale}"
                 windowtitle="Ruimo util" Locale="@{locale}" Encoding="UTF-8"
                 packagenames="com.ruimo.util.*" charset="UTF-8"&gt;
          &lt;link href="http://java.sun.com/javase/6/docs/api"/&gt;
        &lt;/javadoc&gt;
      &lt;/sequential&gt;
    &lt;/macrodef&gt;

    &lt;javadoc-i18n locale="ja"/&gt;
    &lt;javadoc-i18n locale="en"/&gt;
  &lt;/target&gt;
</pre>

<p>
You will get the Japanese and English version of JavaDoc in the directory javadoc-ja and javadoc-en. Of courese, you can easily add other languages as many as you wish.
</p>

<hr/>
<p>
  <a href="http://validator.w3.org/check?uri=referer">
    <img src="http://www.w3.org/Icons/valid-xhtml10"
         alt="Valid XHTML 1.0 Strict" height="31" width="88" />
  </a>
</p>
<p>　<a href="mailto:ruimo@ruimo.com">Any comment will be appreciated.</a>
</p>
<p>　<a href="../..">Back to top page.</a></p>
</body>
</html>
